import{c as T,an as B,ao as E,y as F,D as q,ap as G,_,r as h,aq as H,j as e,L as S,e as J,B as j,al as o,ag as U,S as P,ar as V,C as i,af as $,M as K,G as g,I as Q,z as N}from"./index-55mznCYq.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=T("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ee=()=>{var f,y;const{data:a,isLoading:C}=B(),{data:m,isLoading:k}=E({limit:10}),{data:p}=F(),{data:x}=q(),v=G(),[L,c]=_.useState(!1),[t,n]=_.useState({crop_id:"",region_id:"",price:"",unit:"kg"}),[l,b]=h.useState({}),[M,D]=h.useState(null),R=h.useCallback(({table:s,payload:r})=>{D(new Date);const w={users:["users"],listings:["listings"],orders:["orders"]}[s]||[];w.forEach(u=>{b(d=>({...d,[u]:!0}))}),setTimeout(()=>{b(u=>{const d={...u};return w.forEach(O=>{delete d[O]}),d})},2e3)},[]);H(R);const z=async()=>{if(!t.crop_id||!t.region_id||!t.price){N.error("Please fill all fields");return}try{await v.mutateAsync({crop_id:parseInt(t.crop_id),region_id:parseInt(t.region_id),price:parseFloat(t.price),unit:t.unit}),N.success("Price updated successfully"),c(!1),n({crop_id:"",region_id:"",price:"",unit:"kg"})}catch{N.error("Failed to update price")}};if(C)return e.jsx(S,{children:e.jsx(J,{})});const A=(p==null?void 0:p.map(s=>({value:s.id,label:s.name})))||[],I=(x==null?void 0:x.map(s=>({value:s.id,label:s.name})))||[];return e.jsx(S,{children:e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Admin Dashboard"}),e.jsx("p",{className:"text-neutral-500 mt-1",children:"Platform overview and management"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[M&&e.jsx("span",{className:"live-badge",children:"ðŸŸ¢ Live"}),e.jsx(j,{onClick:()=>c(!0),children:"Update Market Prices"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:l.users?"stat-card-updated":"",children:e.jsx(o,{icon:U,label:"Total Farmers",value:(a==null?void 0:a.total_farmers)||0,color:"primary"})}),e.jsx("div",{className:l.users?"stat-card-updated":"",children:e.jsx(o,{icon:W,label:"Total Buyers",value:(a==null?void 0:a.total_buyers)||0,color:"secondary"})}),e.jsx("div",{className:l.listings?"stat-card-updated":"",children:e.jsx(o,{icon:P,label:"Active Listings",value:(a==null?void 0:a.active_listings)||0,color:"success"})}),e.jsx("div",{className:l.orders?"stat-card-updated":"",children:e.jsx(o,{icon:V,label:"Total Transactions",value:`P${((a==null?void 0:a.total_transaction_value)||0).toLocaleString()}`,color:"warning"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(i,{className:l.orders?"ring-2 ring-primary-200":"",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"section-title",children:"Order Statistics"}),l.orders&&e.jsx("span",{className:"live-update-badge",children:"updated just now"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("span",{className:"text-yellow-800",children:"Pending Orders"}),e.jsx("span",{className:"font-bold text-lg text-yellow-600",children:(a==null?void 0:a.pending_orders)||0})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-green-800",children:"Completed Orders"}),e.jsx("span",{className:"font-bold text-lg text-green-600",children:(a==null?void 0:a.completed_orders)||0})]})]})]}),e.jsxs(i,{className:l.users?"ring-2 ring-primary-200":"",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"section-title",children:"User Distribution"}),l.users&&e.jsx("span",{className:"live-update-badge",children:"updated just now"})]}),e.jsx("div",{className:"space-y-4",children:(f=a==null?void 0:a.user_counts)==null?void 0:f.map(s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"capitalize text-neutral-600",children:[s.role,"s"]}),e.jsx("span",{className:"font-bold",children:s.count})]},s.role))})]})]}),e.jsxs(i,{className:l.users?"ring-2 ring-primary-200":"",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"section-title",children:"Recent Users"}),l.users&&e.jsx("span",{className:"live-update-badge",children:"updated just now"})]}),k?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"spinner"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"text-left text-sm text-neutral-500 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 font-medium",children:"Name"}),e.jsx("th",{className:"pb-3 font-medium",children:"Phone"}),e.jsx("th",{className:"pb-3 font-medium",children:"Role"}),e.jsx("th",{className:"pb-3 font-medium",children:"Region"}),e.jsx("th",{className:"pb-3 font-medium",children:"Status"}),e.jsx("th",{className:"pb-3 font-medium",children:"Joined"})]})}),e.jsx("tbody",{className:"divide-y",children:(y=m==null?void 0:m.users)==null?void 0:y.map(s=>e.jsxs("tr",{className:"hover:bg-neutral-50",children:[e.jsx("td",{className:"py-3 font-medium",children:s.name}),e.jsx("td",{className:"py-3",children:s.phone}),e.jsx("td",{className:"py-3 capitalize",children:s.role}),e.jsx("td",{className:"py-3",children:s.region_name||"-"}),e.jsx("td",{className:"py-3",children:s.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Suspended"})}),e.jsx("td",{className:"py-3 text-sm text-neutral-500",children:new Date(s.created_at).toLocaleDateString()})]},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(i,{className:"hover:border-primary-500 border-2 border-transparent cursor-pointer",children:[e.jsx(U,{size:24,className:"text-primary-500 mb-2"}),e.jsx("h3",{className:"font-semibold",children:"Manage Users"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"View and manage platform users"})]}),e.jsxs(i,{className:"hover:border-primary-500 border-2 border-transparent cursor-pointer",children:[e.jsx($,{size:24,className:"text-primary-500 mb-2"}),e.jsx("h3",{className:"font-semibold",children:"Market Prices"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Update crop prices by region"})]}),e.jsxs(i,{className:"hover:border-primary-500 border-2 border-transparent cursor-pointer",children:[e.jsx(P,{size:24,className:"text-primary-500 mb-2"}),e.jsx("h3",{className:"font-semibold",children:"Monitor Listings"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Review and moderate listings"})]})]}),e.jsx(K,{isOpen:L,onClose:()=>c(!1),title:"Update Market Price",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(g,{label:"Crop",value:t.crop_id,onChange:s=>n(r=>({...r,crop_id:s.target.value})),options:A,placeholder:"Select crop"}),e.jsx(g,{label:"Region",value:t.region_id,onChange:s=>n(r=>({...r,region_id:s.target.value})),options:I,placeholder:"Select region"}),e.jsx(Q,{label:"Price (Pula)",type:"number",step:"0.01",value:t.price,onChange:s=>n(r=>({...r,price:s.target.value})),placeholder:"e.g., 10.00"}),e.jsx(g,{label:"Unit",value:t.unit,onChange:s=>n(r=>({...r,unit:s.target.value})),options:[{value:"kg",label:"per kg"},{value:"ton",label:"per ton"},{value:"bag",label:"per bag"}]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(j,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(j,{onClick:z,loading:v.isPending,className:"flex-1",children:"Update Price"})]})]})})]})})};export{ee as default};

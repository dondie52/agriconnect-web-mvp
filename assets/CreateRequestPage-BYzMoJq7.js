import{u as C,y as N,D as R,Q as k,r as g,j as a,L as P,C as S,G as c,I as x,T as w,B as y,z as h}from"./index-55mznCYq.js";const I=()=>{const p=C(),{data:o}=N(),{data:l}=R(),d=k(),[e,b]=g.useState({crop_id:"",quantity:"",unit:"kg",max_price:"",region_id:"",notes:""}),[u,m]=g.useState({}),v=(o==null?void 0:o.map(t=>({value:t.id,label:t.name})))||[],q=(l==null?void 0:l.map(t=>({value:t.id,label:t.name})))||[],_=[{value:"kg",label:"Kilograms (kg)"},{value:"ton",label:"Tons"},{value:"bag",label:"Bags"},{value:"crate",label:"Crates"}],s=t=>{const{name:n,value:i}=t.target;b(r=>({...r,[n]:i})),u[n]&&m(r=>({...r,[n]:""}))},f=()=>{const t={};return e.crop_id||(t.crop_id="Crop type is required"),(!e.quantity||e.quantity<=0)&&(t.quantity="Valid quantity is required"),m(t),Object.keys(t).length===0},j=async t=>{var n,i;if(t.preventDefault(),!!f())try{await d.mutateAsync({crop_id:parseInt(e.crop_id),quantity:parseFloat(e.quantity),unit:e.unit,max_price:e.max_price?parseFloat(e.max_price):null,region_id:e.region_id?parseInt(e.region_id):null,notes:e.notes}),h.success("Request posted successfully!"),p("/buyer-requests")}catch(r){h.error(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to post request")}};return a.jsx(P,{children:a.jsxs("div",{className:"max-w-2xl mx-auto animate-fadeIn",children:[a.jsx("h1",{className:"page-title mb-6",children:"Post Produce Request"}),a.jsx("p",{className:"text-neutral-500 mb-6",children:"Let farmers know what produce you're looking for."}),a.jsx(S,{children:a.jsxs("form",{onSubmit:j,className:"space-y-6",children:[a.jsx(c,{label:"Crop Type *",name:"crop_id",value:e.crop_id,onChange:s,options:v,placeholder:"Select crop type",error:u.crop_id}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(x,{label:"Quantity Needed *",name:"quantity",type:"number",step:"0.1",min:"0",value:e.quantity,onChange:s,placeholder:"e.g., 100",error:u.quantity}),a.jsx(c,{label:"Unit",name:"unit",value:e.unit,onChange:s,options:_})]}),a.jsx(x,{label:"Maximum Price per Unit (Pula) - Optional",name:"max_price",type:"number",step:"0.01",min:"0",value:e.max_price,onChange:s,placeholder:"Leave blank for flexible"}),a.jsx(c,{label:"Preferred Region - Optional",name:"region_id",value:e.region_id,onChange:s,options:q,placeholder:"Any region"}),a.jsx(w,{label:"Additional Notes",name:"notes",value:e.notes,onChange:s,placeholder:"Specify quality requirements, delivery needs, timeline, etc.",rows:4}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx(y,{type:"button",variant:"outline",onClick:()=>p(-1),children:"Cancel"}),a.jsx(y,{type:"submit",loading:d.isPending,className:"flex-1",children:"Post Request"})]})]})})]})})};export{I as default};

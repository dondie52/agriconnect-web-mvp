import{c as N,u as L,r as m,a as w,b as C,j as e,L as P,d as u,P as z,e as M,E as b,S as k,C as S,f as E,g as q,h,B as t,i as A,M as B,z as g}from"./index-55mznCYq.js";import{T as I}from"./trash-2-Cg9PM5aX.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=N("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),O=()=>{var x;const r=L(),[c,p]=m.useState(1),[i,n]=m.useState({open:!1,listing:null}),{data:a,isLoading:j}=w({page:c,limit:10}),d=C(),o=(a==null?void 0:a.listings)||[],f=(a==null?void 0:a.totalPages)||1,y=async()=>{if(i.listing)try{await d.mutateAsync(i.listing.id),g.success("Listing deleted successfully"),n({open:!1,listing:null})}catch{g.error("Failed to delete listing")}};return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"My Listings"}),e.jsx("p",{className:"text-neutral-500 mt-1",children:"Manage your produce listings"})]}),e.jsxs(u,{to:"/create-listing",className:"btn-primary inline-flex items-center gap-2",children:[e.jsx(z,{size:20}),"Create Listing"]})]}),j?e.jsx(M,{}):o.length===0?e.jsx(b,{icon:k,title:"No listings yet",description:"Create your first listing to start selling your produce.",action:e.jsx(u,{to:"/create-listing",className:"btn-primary",children:"Create Listing"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-4",children:o.map(s=>{let l=[];try{Array.isArray(s.images)?l=s.images:typeof s.images=="string"&&(l=JSON.parse(s.images))}catch{l=[]}const v=l[0];return e.jsxs(S,{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"w-full md:w-40 h-32 flex-shrink-0 rounded-lg overflow-hidden",children:e.jsx(E,{src:v,alt:s.crop_name,className:"w-full h-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.crop_name}),e.jsx("p",{className:"text-neutral-500 text-sm",children:s.region_name})]}),e.jsx(q,{status:s.status})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4 text-sm",children:[e.jsxs("span",{children:[e.jsxs("strong",{className:"text-primary-600",children:["P",s.price]}),"/",s.unit]}),e.jsxs("span",{children:[s.quantity," ",s.unit," available"]}),e.jsxs("span",{className:"flex items-center gap-1 text-neutral-500",children:[e.jsx(h,{size:14}),s.views||0," views"]})]}),s.description&&e.jsx("p",{className:"mt-2 text-neutral-600 text-sm line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex md:flex-col gap-2 md:justify-start",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>r(`/listings/${s.id}`),children:e.jsx(h,{size:16})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>r(`/farmer/edit-listing/${s.id}`),children:e.jsx(_,{size:16})}),e.jsx(t,{variant:"ghost",size:"sm",onClick:()=>n({open:!0,listing:s}),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(I,{size:16})})]})]},s.id)})}),e.jsx(A,{page:c,totalPages:f,onPageChange:p})]}),e.jsx(B,{isOpen:i.open,onClose:()=>n({open:!1,listing:null}),title:"Delete Listing",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-neutral-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:(x=i.listing)==null?void 0:x.crop_name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(t,{variant:"outline",onClick:()=>n({open:!1,listing:null}),children:"Cancel"}),e.jsx(t,{variant:"danger",onClick:y,loading:d.isPending,children:"Delete"})]})]})})]})})};export{O as default};
